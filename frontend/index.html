<!DOCTYPE html>
<html>
<head>
    <title>GrocerX</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Animated grocery background -->
<div class="bg-pattern">
    <span>ğŸ</span><span>ğŸ¥•</span><span>ğŸ¥¦</span><span>ğŸ</span><span>ğŸ¥›</span>
    <span>ğŸŒ</span><span>ğŸ…</span><span>ğŸ¥¬</span><span>ğŸ§€</span><span>ğŸ‰</span>
    <span>ğŸ</span><span>ğŸ¥•</span><span>ğŸ¥¦</span><span>ğŸ</span><span>ğŸ¥›</span>
    <span>ğŸŒ</span><span>ğŸ…</span><span>ğŸ¥¬</span><span>ğŸ§€</span><span>ğŸ‰</span>
</div>

<div class="app">

    <header>
        <h1>ğŸ¥¬ GrocerX</h1>
        <p>Smart Grocery Management System</p>
    </header>

    <!-- Add Grocery -->
    <div class="card">
        <h2>Add Grocery</h2>

        <input type="text" id="itemName" placeholder="Item name">

        <div class="qty-row">
            <input type="number" id="quantity" placeholder="Quantity">
            <select id="quantityUnit">
                <option value="kg">âš–ï¸ kg</option>
                <option value="items">ğŸ”¢ items</option>
            </select>
        </div>

        <input type="date" id="expiryDate">
        <button onclick="addItem()">Add Item</button>
    </div>

    <!-- âœ… ADDED ITEMS FIRST -->
    <div class="card">
        <h2>Added Items</h2>
        <ul id="itemList"></ul>
    </div>

    <!-- âœ… EXPIRY ALERTS -->
    <div class="card alert-card">
        <h2>Expiry Alerts</h2>
        <ul id="expiryAlert">
            <li>No items expiring soon</li>
        </ul>
    </div>

    <!-- âœ… SHOPPING LIST -->
    <div class="card">
        <h2>Shopping List</h2>
        <ul id="shoppingList">
            <li>No items to buy yet</li>
        </ul>
    </div>

</div>

<script>
    let items = [];

    /* âœ… DATE FORMAT: 04 Feb 2025 (Wed) */
    function formatDate(date) {
        const day = String(date.getDate()).padStart(2, '0');
        const month = date.toLocaleString('en-US', { month: 'short' });
        const year = date.getFullYear();
        const weekday = date.toLocaleString('en-US', { weekday: 'short' });
        return `${day} ${month} ${year} (${weekday})`;
    }

    function addItem() {
        const name = document.getElementById("itemName").value.trim();
        const quantity = parseFloat(document.getElementById("quantity").value);
        const unit = document.getElementById("quantityUnit").value;
        const expiryValue = document.getElementById("expiryDate").value;

        if (!name || isNaN(quantity) || quantity <= 0) {
            alert("Enter valid item name and quantity");
            return;
        }

        let expiryDate;

        // Vegetables â†’ estimated expiry
        if (unit === "kg" && !expiryValue) {
            expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + 7);
        } else {
            expiryDate = new Date(expiryValue);
        }

        items.push({ name, quantity, unit, expiryDate });
        updateAll();

        document.getElementById("itemName").value = "";
        document.getElementById("quantity").value = "";
        document.getElementById("expiryDate").value = "";
    }

    function updateAll() {
        updateItems();
        updateExpiryAlerts();
        updateShoppingList();
    }

    function updateItems() {
        const ul = document.getElementById("itemList");
        ul.innerHTML = "";

        items.forEach(item => {
            const li = document.createElement("li");
            li.innerHTML = `
                <strong>${item.name}</strong>
                <span>Quantity: ${item.quantity} ${item.unit}</span>
                <span>Expiry: ${formatDate(item.expiryDate)}</span>
            `;
            ul.appendChild(li);
        });
    }

    function updateExpiryAlerts() {
        const ul = document.getElementById("expiryAlert");
        ul.innerHTML = "";

        const today = new Date();
        let found = false;

        items.forEach(item => {
            const daysLeft = Math.ceil((item.expiryDate - today) / 86400000);
            if (daysLeft <= 30) {
                found = true;
                const li = document.createElement("li");
                li.textContent = `${item.name} expires in ${daysLeft} days`;
                ul.appendChild(li);
            }
        });

        if (!found) {
            ul.innerHTML = "<li>No items expiring soon</li>";
        }
    }

    function updateShoppingList() {
        const ul = document.getElementById("shoppingList");
        ul.innerHTML = "";

        const today = new Date();
        let found = false;

        items.forEach(item => {
            const daysLeft = Math.ceil((item.expiryDate - today) / 86400000);
            if (daysLeft <= 30) {
                found = true;
                const li = document.createElement("li");
                li.textContent = `${item.name} (use / buy soon)`;
                ul.appendChild(li);
            }
        });

        if (!found) {
            ul.innerHTML = "<li>No items to buy yet</li>";
        }
    }

    /* â± Demo auto update */
    setInterval(updateAll, 10000);
</script>

</body>
</html>
